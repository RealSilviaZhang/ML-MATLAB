% Newton's method
clear; clf; format long
f=@(x) 4*cos(2*x)-(x-2).^2;
fp=@(x) -8*sin(2*x)-2*(x-2);
x=linspace(-2,5,100);
plot(x,f(x)); grid on; hold on
p(1)=2.5; 
plot(p(1),0,'bo')
plot(p(1),f(p(1)),'r*')
tol=1.0e-15; err=2*tol;
i=1;
while err>tol
y=f(p(i))+fp(p(i))*(x-p(i));
plot(x,y)
p(i+1)=p(i)-f(p(i))/fp(p(i));
plot(p(i+1),0,'bo')
err=abs(p(i+1)-p(i));
i=i+1;
end
title('Aoxuan Zhang')
p'
length(p)-1

% untitled3
% 
% ans =
% 
%    1.000000000000000
%    0.494805523696309
%    0.475885954556382
%    0.475320646985451
%    0.475320125801657
%    0.475320125801213
%    0.475320125801214
% 
% 
% ans =
% 
%      6
% ans =
% 
%    0.500000000000000
%    0.476206779355203
%    0.475321403597543
%    0.475320125803879
%    0.475320125801213
%    0.475320125801214
% 
% 
% ans =
% 
%      5
% ans =
% 
%    2.500000000000000
%    2.367396721631251
%    2.373643280212187
%    2.373649807961834
%    2.373649807969355
%    2.373649807969355
% 
% 
% ans =
% 
%      5
% 
% ans =
% 
%   -0.100000000000000
%   -0.015407896294122
%   -0.000499421831093
%   -0.000000559941336
%   -0.000000000000705
%   -0.000000000000000
%   -0.000000000000000
% 
% 
% ans =
% 
%      6